= DOMAINS


== Definition of A Domain

A DOMAIN is the fundamental class within the UDG for describing the various things, agents, and places that make up the Spatial Web. Every structure, building, planet, character (agent), animal, mystical alien pyramid or similar construct, is ultimately a DOMAIN, and is addressable within the context of the spatial web.

A DOMAIN  can be thought of as an area of concern in which things happen. While this may (and most likely will) be a physical construct, it doesn't necessarily have to be.

A DOMAIN is an ENTITY that may identify the context for an ACTIVITY for or by an AGENT at a specific place acting upon various things within that DOMAIN. Everything that happens within the UDG happens within a DOMAIN.

A DOMAIN can be a Spatial Web representation of a thing. Internally this DOMAIN is represented as a graph of information that describes its identifier, changing in response to changes in its environment (the domain graph in which it resides, which is composed of the graphs of other entities in that system).

There are a specific set of attributes which are required for the DOMAIN. Specifically, a DOMAIN must have:

* a Spatial Web Identifier or SWID, a form of decentralized identifier that can be used to identify the domain uniquely within the Spatial Web.
* A DOMAON Type, which indicates the particular role that the domain plays. This identifies how the domain is classified within the Spatial Web. Note that a DOMAIN can be defined by multiple different ontologies, but it _must_ have the domain type.

A DOMAIN may have other other attributes, but these are not required:

* A __location__, which identifies the entity's position in a state space (or __hyperspace__), relative to either the containing domain, or to an externally defined domain. If a domain exists solely as a vehicle for containment, then location is not specifically required, though it often contains additional state information that is not strictly speaking positional.
* Zero or more __activities__, which provides the operational instructions for the entity in question. The structure of the activity is language independent and declarative.
* Zero or more __style__ resources, which provides a mechanism for rendering the entity with different content types. _Please note, this has not been formally proposed yet, and may be removed_.
* Zero or one __link__ references to an external domain. Some entities provide a link that can be activated through certain interfaces or affordances. This is a simple link, meaning it changes the context (domain) of the agent initiating the link without specific constraints, which is analogous to an HTTP standard hyperlink. More information about links will be covered in the subsection [Links](#links).

A DOMAIN is a system. The DOMAIN provides the answers to a number of key questions about the system in question.

* __Where?__. Where (what place) does the action within the system take place?
* __How Is Space Defined?__ What are the relevant places of relevance within the system (it's hyperspace).
* __How Is Spae Connected?__. How are things within the domain connected, and how are domains connected to other domains?
* __What Happened?__. Is it possible to retrieve a history of what happened within the domain over time?
* __What Kind?__. What classifications apply to the domain?
* __Who?__. Which agents are participating within the domain?
* __When?__. When does the activity take place within the context of the domain. This becomes especially critical for asynchronous events.
* __What Happened?__. Is it possible to retrieve a history of what happened within the domain over time?
* __How?__. What are the activities that can be accomplished within the domain, and how are these activated?
* __Why?__. What are the goals or purposes of the domain, and what happens when those goals are achieved?


DOMAONS exist within hyperspace including time. DOMAONS usually have a specific start time (or other condition) and end time (or other condition).

In general, a domain has a schematic representation that can be extended from a core domain type. This identifies the relevant state variables and properties for the domains beyond the properties of the Domain base class. Domains are entities in that they have swids, but they are in effect system (or holonic) entities.


== Domain as a map

A DOMAON is a model. It provides context for the things within the model, and also describes a purpose for that model. It is, in a very real sense, a __map__, albeit one that is self-aware and changes dynamically over time, though the question about what a domain is a map ___of___ is something that is dependent upon the author or model maker.

Something that is central to the spatial web is that it is __not__ necessarily a reflection of reality. As with any map, a domain is an abstraction of a (typically physical) space and the entities that evolve within that space over time. For instance, one can create a domain showing the London subway system:

![London Subway System 2025](images/_116112246_064832377.jpg.webp)

The domain can even be seen as a representation showing where the individual trains are  within that subway system (to a close approximation). Note that such a map is not necessarily spatially correct - it shows routes and stations, but these are not positionally correct. In this case, what you are looking at is a topological construct, simplified to show what is relevant, not necessarily what is a detailed reflection of the subway on (or in this case under) the ground.

To that end, designing a domain typically comes down to answering a number of questions:

* __What is this a map of?__ Most maps show things of significance within a given context. Why is the map being created? what is it's purpose? Just as a document exists in the world wide web to inform, entertain, record, and persuade, a domain exists in the spatial web for much the same thing. 
* __Does the map change over time?__ Until recently, all maps were effectively just snapshots in time, and it has only been comparatively recently that we could create maps that capture evolution of a system over time.
* __Does the map reflect changes in the real world?__ This is a more subtle question, but an important one. Is there some form of feedback between a physical array of sensors and cameras that drive the evolution of the model, or is the driving factor in the map some form of algorithm or AI (a simulation).
* __Can changes to the map cause changes in the real world?__ Put another way, if a user of the map indicates a change be made to some entity within that map, will that change be reflected in the real world system that the map is a reflection of? Is it interactive?
* __Is the map participatory?__ Are there other agents that can change the state of the map (whether it reflects physical reality or not) and how do they interact with that map? How are changes in the map expressed back to the user.
* __Is the map linked to other maps?__ Does the map describe a comprehensive system, or is it possible to change to a different map based upon linking, tiling or similar system?
* __Does the map have multiple levels of detail (LOD)?__ Can you zoom in on an area to get more detail? Do you need to provide metadata (text and image content)? Is it dynamic?
* __Does the map have persistance?__ When an agent enters the map, will that map reflect changes made to it by others (an environment), or are changes lost between sessions (typical of tours)? 
* __Who or what is the intended audience of the map?__ Is this used primarily by humans or by automated systems? 

The role of the Spatial Web system is to deliver these different kinds of maps, to make them integrated and useful across a wide variety of applications. Just as the world wide web exploded the concept of a library - a collection of documents - into a world-wide phenomenon, so too does the creation of domains enable the same thing for maps as a way of perceiving and understanding the worlds, both real and imagined, around us.

== Agents Are Not Domains, They Have Domains

One of the long-standing debates within the spatial web working group has been the distinction between a domain and an agent, what is frequently referred to as the holonic paradox. A smart city, for instance, is both a domain (a context in which agents interoperate) and an agent (a thing that has changeable state but can be treated as a distinct entity). 

Ultimately, this distinction can be thought of as a distinction between __external state__ - the state of an entity as perceived by the environment - vs. __internal state__, which is the state of the components that make up that thing relative to one another.

_For purposes of modeling_, all entities have external (extrinsic or percieved) state, however, not all entities necessarily have internal (or intrinsic) state, _within the model_. 

> The physical world does not, of course, have such a natural division; the viscera of a person, for instance, is still in the same "reality" as the outer form of that person, and that reality extends from the largest scales of the universe to the smallest quarks. However, the virtual world does not have that same constraint, and as such it is usually preferable to create holistically contained models that handle relevant aspects of the system in question.

What this means in practice is simple. All domains are effectively bound to agents as the "inside" of some thing is still connected to that thing. If you were to create an internal model of yourself, that domain's interactions would likely have some reflection in your external state. The boundary between external state and internal state is an interface. If you have a stomach ache, your expression (one aspect of that interface) will be sour and pained.

By this same reasoning, in the spatial web, the distinction between the domain where an entity is an agent and the domain representing the internal state of that entity is a form of link. If I have a special scanner that shows your insides, what you are seeing is a ___map___ of the "insides" domain through that link. 

> Note again that this is different from reality. An MRI uses a magnetic field sensor coupled with strong magnets to generate and interpret the internals of a person, but an endoscopy actually creates an agent (the camera end of a fiber optic cable) that invades that domain. In the virtual world, on the other hand, the camera becomes a part of the internal domain but acts as an interface to create a map or view of the internal domain to display within the context of the external domain.

This relationship can be seen as follows:

```mermaid
graph LR

    baseAgent[<b>Agent</b><br>Base Agent]
    subgraph agentDomain[<b>Domain:</b>Agent Domain]
       proxyDomain[<b>Domain</b><br>Proxy Domain]
       childAgent[<b>Agent</b><br>Child Agent]
       proxyDomain -->|has Agent| childAgent
    end
    baseAgent -->|has Domain| agentDomain
```

In this case, the agent has a property called `hsml:hasDomain`. This points to a named graph, with the name being the IRI for the agent's domain. Within the named graph, there exists a proxy domain (probably a blank node), that acts as the representative of the base agent within the subordinated domain graph.

The named graph represents a ___Markov Boundary___. 

One final point before digging into links. In theory, an agent can have multiple domains that represent different aspects or systems for that agent. So long as the domains are completely independent, this is an effective strategy, but if two domains are descriptive of the same system, then either these domains need to be linked together in some way or the internal domain needs to model all of these potentially interrelated subsystems.


= Domains, Links and Hyperspaces

Places have an obvious containment relationship - Earth is made up of continents, which are made up of ountries, which are made up of cities, which are made up of even smaller divisions.

Domains are not places, though they might appear to be at first glance. A domain has a place property that can in fact refer to multiple places. For instance, one can make up a domain of Red States, a domain of Blue States, and possible a domain of Purple States in the United States. It also has a Home place property that acts as a default when the domain is referenced as the target of a link - this can be thought of as the equivalent of a landing page (or index.html in HTTP terms).

This creates an interesting phenomenon. The most common form of link within the UDG is a link from one place to another place typically within the same domain. The links exist primarily for agents, but an agent may also have the ability to carry certain things from one place to another within a given domain.

This is different behavior from the way that a link works in HTTP. There, activating a link sends the browser (the user agent) to a new address. With HSTP, activating a link will typically move the agent to a new Place within the domain. In a game environment such as Monopoly, this basically moves the agent's token to the new place (say from Pennsylvania Ave to Boardwalk). In a game like chess, each player in effect controls sixteen agents, one for each chess piece on their side, though they can only control one such agent at any given turn.

This also raises an interesting quandry. Links can be contextual, and are also not necessarily contiguous. The valid links for a knight agent, for instance, is L shaped, and it can jump over adjacent squares, but can't jump outside of the boundaries of the board. The bishop can only move across diagonals, and only until it encounters a piece of the opposite's side (a capture) or a piece of the active side (a block). This indicates that the hyperspace of a domain is topological.

== The Topological Hyperspace

A topological space is one in which direct physical constraints are minimized in favor of conceptual ones. In effect, a domain consists of a set of places, each of which is a conceptual node connected by links. The set of all places that are traversable within the graph makeup the hyperspace for that domain, with the links in turn controlling access from one place to another within the domain.

```mermaid
---
config:
    layout: elk
---
graph LR
    r1[Room1]
    r2[Room2]
    r3[Room3]
    r4[Room4]
    r5[Room5]
    r6[Room6]
    r1 -->|=9758;| r2
    r1 -->|=9919;| r3
    r2 -->|=9919;| r4
    r3 -->|=9758;| r4
    r2 -->|=9758;| r3
    r4 -->|=9719;| r5
    r4 -->|=9758;| r6
```
In this case, the hyperspace for the domain consists of six "rooms", each connected by links of various types:
* Pointers (&=9758;) represent open links - an agent can move from one room to the next freely.
* Keys (&=9919;) represent locked links - the agent needs some form of key to open the link and move to the next room.
* Finally, clocks (&=9719;) represents conditional locks - an external condition (such as a store being closed for the night) must be met before traversal can happen.

This is an example of a topological domain. It consists of six Places, but each Place does not necessarily have to represent a physical location in the real world. Instead, the place is simply a scope for containment. It could represent stations in an assembly line, steps in a process, a detailed internal representation of a given subsystem, and so forth.

The notion of linked places can be used to create an alternative for managing holonic viewpoints. For instance, if you have a place that represents a car, there is a link (perhaps the button that releases the latch that holds the hood closed), which will then take you to an entry place ("room") that contains the engine compartment, and that lets you in turn dig deeper into the engine, the battery, the alternator and so forth.

This approach has a number of key advantages - first - you can control access to various subsystems because they are topological just places within the overall domain that are constrained by the links that connect them. Because links are contextual, you can only access certain subsystem if either you (or your agent) have the relevant key or some external condition is in force.

This also relieves the Spatial Web of having to do heavy extensive physical mapping. This can be added back in, either by increasing the number of places to better represent a tighter partitioning of the space, or by providing more subtle links to create more neighborhoods (these are essentially equivlent actions).

The hyperspace of the domain then becomes the set of all places within that domain. This solves another problem that a more physical realization introduces - determining whether you are at the edge of, or out of the boundaries of, a physical space. In a topological model, if the place is not in the domain, then it is not accessible by ANY agent.

== Topological vs Continuous Hyperspace

The topological view is one where a domain consists of a finite number of discrete places, each with its own SWID.




