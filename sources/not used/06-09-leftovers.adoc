

=== Domains, Links and Hyperspaces

Places have an obvious containment relationship - Earth is made up of
continents, which are made up of ountries, which are made up of cities, which
are made up of even smaller divisions.

Domains are not places, though they might appear to be at first glance. A domain
has a place property that can in fact refer to multiple places. For instance,
one can make up a domain of Red States, a domain of Blue States, and possible a
domain of Purple States in the United States. It also has a Home place property
that acts as a default when the domain is referenced as the target of a link -
this can be thought of as the equivalent of a landing page (or index.html in
HTTP terms).

This creates an interesting phenomenon. The most common form of link within the
UDG is a link from one place to another place typically within the same domain.
The links exist primarily for agents, but an agent may also have the ability to
carry certain things from one place to another within a given domain.

This is different behavior from the way that a link works in HTTP. There,
activating a link sends the browser (the user agent) to a new address. With
HSTP, activating a link will typically move the agent to a new Place within the
domain. In a game environment such as Monopoly, this basically moves the agent's
token to the new place (say from Pennsylvania Ave to Boardwalk). In a game like
chess, each player in effect controls sixteen agents, one for each chess piece
on their side, though they can only control one such agent at any given turn.

This also raises an interesting quandry. Links can be contextual, and are also
not necessarily contiguous. The valid links for a knight agent, for instance, is
L shaped, and it can jump over adjacent squares, but can't jump outside of the
boundaries of the board. The bishop can only move across diagonals, and only
until it encounters a piece of the opposite's side (a capture) or a piece of the
active side (a block). This indicates that the hyperspace of a domain is
topological.



=== Topological vs Continuous Hyperspace

The topological view is one where a domain consists of a finite number of
discrete places, each with its own SWID.

=== Domain as a map

A DOMAIN is a model. It provides context for the things within the model, and also describes a purpose for that model. It is, in a very real sense, a __map__, albeit one that is self-aware and changes dynamically over time, though the question about what a domain is a map ___of___ is something that is dependent upon the author or model maker.

Something that is central to the spatial web is that it is __not__ necessarily a reflection of reality. As with any map, a domain is an abstraction of a (typically physical) space and the entities that evolve within that space over time. For instance, one can create a domain showing the London subway system:

image::_116112246_064832377.jpg[London Subway System 2025]

The domain can even be seen as a representation showing where the individual trains are within that subway system (to a close approximation). Note that such a map is not necessarily spatially correct - it shows routes and stations, but these are not positionally correct. In this case, what you are looking at is a topological construct, simplified to show what is relevant, not necessarily what is a detailed reflection of the subway on (or in this case under) the ground.

To that end, designing a domain typically comes down to answering a number of questions:

* __What is this a map of?__ Most maps show things of significance within a given context. Why is the map being created? what is it's purpose? Just as a document exists in the world wide web to inform, entertain, record, and persuade, a domain exists in the spatial web for much the same thing.
* __Does the map change over time?__ Until recently, all maps were effectively just snapshots in time, and it has only been comparatively recently that we could create maps that capture evolution of a system over time.
* __Does the map reflect changes in the real world?__ This is a more subtle question, but an important one. Is there some form of feedback between a physical array of sensors and cameras that drive the evolution of the model, or is the driving factor in the map some form of algorithm or AI (a simulation).
* __Can changes to the map cause changes in the real world?__ Put another way, if a user of the map indicates a change be made to some entity within that map, will that change be reflected in the real world system that the map is a reflection of? Is it interactive?
* __Is the map participatory?__ Are there other agents that can change the state of the map (whether it reflects physical reality or not) and how do they interact with that map? How are changes in the map expressed back to the user.
* __Is the map linked to other maps?__ Does the map describe a comprehensive system, or is it possible to change to a different map based upon linking, tiling or similar system?
* __Does the map have multiple levels of detail (LOD)?__ Can you zoom in on an area to get more detail? Do you need to provide metadata (text and image content)? Is it dynamic?
* __Does the map have persistance?__ When an agent enters the map, will that map reflect changes made to it by others (an environment), or are changes lost between sessions (typical of tours)?
* __Who or what is the intended audience of the map?__ Is this used primarily by humans or by automated systems?

The role of the Spatial Web system is to deliver these different kinds of maps, to make them integrated and useful across a wide variety of applications. Just as the world wide web exploded the concept of a library - a collection of documents - into a world-wide phenomenon, so too does the creation of domains enable the same thing for maps as a way of perceiving and understanding the worlds, both real and imagined, around us.




=== Places

A __place__ represents a particular bounded region with a domain. The set of all places inside of a domain identifies the
__hyperspace__ of that domain.

Note that a place is a conceptual entity, not necessarily just a geophysical
one. The role of a place is to indicate _where_ a particular agent performs a
specific activity within a given domain, and an agent will always be connected
to a place, though the specific place may change from one domain to the next.

Within this context, a _tour_ can be thought of as the navigation of an agent
through various places within a given domain. The specific mechanisms for how
that agent moves from place to place are abstracted out in HSML, which is not
necessarily a high fidelity representation of the physical world. What is
important is only that the agent has moved from one operational context to
another.

As mentioned, a place is itself an agent, and is an abstraction. For instance,
suppose that you were representing a field hospital in a wartime setting. This
is a place - it is where agents perform activities - but it is not necessarily
fixed in space. When you say, "I am going to Field Hospital 4077", for
instance, what you are indicating is that you are going to a place but the
specific location of that place will vary over time.

This becomes especially important when dealing with vessels or platforms of
various sorts. A cruise ship is a place, but its position will vary. That ship,
in turn, can be decomposed (in its own subdomain) into multiple decks, rooms and
cabins, each of which are also places.

Two critical points to note:

* A domain can have just a single place. If there is no particular need to
indicate changes in spatial focus, then only one place is needed.* An agent may
specify a location on its associated place, in either ___absolute___ or
___relative____ terms.

** An __absolute location__ is one given by an absolute coordinate system such
as h3 or wgs-84, and assumes an orthogonal vector system used for specifying
position, orientation and/or extent. This is typically used for larger scale
domains, such as those on a planet. It may also be a custom tiling system where
each tile has a specific address.

** A __relative location__ is a little more complicated to define, and is
strictly speaking Euclidean. In this particular case, the domain identifies a
set of places within it and associates each place with an orthogenal vector,
along with one place that's an origin vector (a point). These places are
markers, with n + 1 markers where n is the desired dimension, and n = 0
represents the origin. Once these are defined, any place can be defined relative
to the corresponding coordinate system. Note, these do not necessarily need to
be cartesian - you can set a 2D space as (r,Î¸), for instance.

One advantage of using relative coordinates is that it can be used to simplify
modeling of smaller structures. For instance, suppose that you wanted to model
an apartment. You can set this up as follows:

[source]
----
[] a hsml:Domain ;
    hsml:swid did:swid:ACE11921CD587AF245 ;
    hsml:swurl <domain/standardApartment-ACE11921CD587AF245>
    hsml:hyperspace (_:origin _:x-axis :y-axis);
    hsml:hasPlaces _:livingRoom, _:kitchen, _:bedroom, _:bathroom ;
    hsml:hasHomePlace _:livingRoom ;
    .
_:origin a hsml:Place ;
    hsml:hasLocation (0 0) ;
    hsml:hasUnits <concept/units/feet> ;
    .
_:x-axis a hsml:Place ;
    hsml:hasLocation (1 0) ;
    hsml:hasUnits <concept/units/feet> ;
    .

_:y-axis a hsml:Place ;
    hsml:hasLocation (0 1) ;
    hsml:hasUnits <concept/units/feet> ;
    .

_:livingRoom a hsml:Place ;
    hsml:hasLocation (0 0) ;
    hsml:hasExtent (12 8) ;
    hsml:hasTopic <concept/Room> ;
    hsml:hasAgent [
        # door from LR to Kitchen
        a hsml:Agent ;
        hsml:hasTopic topic:Door ;
        hsml:hasLocation (12 4);
        hsml:hasLink [
            hsml:hasTarget _:kitchen ;
        ] , [
        # door from LR to Bedroom
        a hsml:Agent ;
        hsml:hasTopic topic:Door ;
        hsml:hasLocation (6 8) ;
        hsml:hasLink [
            hsml:hasTarget _:kitchen ;
        ]

    ],[
        # a person agent standing in to the living room
        a hsml:Agent ;
        hsml:swurl <agent/JaneDoe> ;
        hsml:hasTopic topic:Person, topic:Woman ;
        hsml:hasLocation (7,3) ;
    ].

_:kitchen a hsml:Place ;
    hsml:hasLocation (12 0) ;
    hsml:hasExtent (6 8) ;
    hsml:hasTopic <concept/Room> ;
    hsml:hasAgent [
        # door from Kitchen to LR
        a hsml:Agent ;
        hsml:hasTopic topic:Door ;
        hsml:hasLocation (12 4);
        hsml:hasLink [
            hsml:hasTarget _:livingRoom ;
        ]
    ]
    .

_:bedroom a hsml:Place ;
    hsml:hasLocation (0 8) ;
    hsml:hasExtent (10 8) ;
    hsml:hasTopic <concept/Room> ;
    hsml:hasAgent [
        # door from LR to Bedroom
        a hsml:Agent ;
        hsml:hasTopic topic:Door ;
        hsml:hasLocation (6 8) ;
        hsml:hasLink [
            hsml:target _:livingRoom ;
        ], [
        # door from Bedroom to Bathroom
        a hsml:Agent ;
        hsml:hasTopic topic:Door ;
        hsml:hasLocation (10 12) ;
        hsml:hasLink [
            hsml:hasTarget _:bathroom ;
           ]
        ]
    .

_:bathroom a hsml:Place ;
    hsml:hasLocation (10 8) ;
    hsml:hasExtent (8 8) ;
    hsml:hasTopic <concept/Room> ;
    hsml:hasAgent [
        # door from Bedroom to Bathroom
        a hsml:Agent ;
        hsml:hasTopic topic:Door ;
        hsml:hasLocation (10 12) ;
        hsml:hasLink [
            hsml:hasTarget _:bathroom ;
           ]
        ]
    .
----

This can be interpreted as follows:

.Apartment Floorplan
image::apartment_floorplan-1-svg-08-16-2025_12_34_PM.png[]

Several key points:


* _None of this has been normalized yet within the working group, so may
change._

* The () notation indicates an ordered linked list, which is used for any
ordered sequence of items in RDF.

* The use of the blank node (underscore notation) is to create local identifiers
rather than global identifiers, and will be replaced by system scope identifiers
when loaded into the graph.

* Hyperspace here is identified by three places - an origin and two orthogonal
vectors.

* Units are treated as conceptual entities in the taxonomy and are defined at
the level of the spatial web node. If units are not included, then the default
is an undifferentiated unit.

* The domain identifies the active places within the system (coordinate axes are
usually not included as they don't normally take active agents).

* Each place has a location that identifies where it is relative to either a
global coordinate system or a custom (relative) system.

* Agents are attached to places via the hsml:hasAgent predicate. In this
particular case, the agents are doors with attached links that allow for transit
between two rooms. Note that the door or portal agents have locations within the
local coordinate system (and can have extents, though they are not necessary
here). There is an additional icon showing a person and their current position
within the apartment.

* The `hsml:hasExtent` predicate identifies the boundaries of a place. Note that
such boundaries may be multi-dimensional in nature, and may be specified in a
number of different ways. The `hsml:hasTopic` predicate can be used to clarify
how this boundary is expressed, as indicated in the section
link:#extending-entities[Extending Entities].







.Topology example of Ontario cities
image::topology_ontario_cities.png[Topology example of Ontario cities]

// [source,mermaid]
// ----
// graph TD
//    subgraph Ontario Region Cities
//        Toronto(Toronto)
//      Ottawa(Ottawa)
//        Montreal_QC(Montreal - Quebec)
//        Hamilton(Hamilton)
//        London(London)
//        Windsor(Windsor)
//        Kingston(Kingston)
//        Sudbury(Sudbury)
//        ThunderBay(Thunder Bay)
//        Winnipeg_MB(Winnipeg - Manitoba)
//
//        Toronto --- Hamilton
//        Toronto --- London
//        Toronto --- Kingston
//        Toronto --- Ottawa
//
//        Ottawa --- Montreal_QC
//        Ottawa --- Kingston
//
//        Hamilton --- London
//        Hamilton --- Windsor
//
//        London --- Windsor
//
//        Kingston --- Montreal_QC
//
//        Sudbury --- Toronto
//        Sudbury --- ThunderBay
//
//        ThunderBay --- Winnipeg_MB
//    end
//
//    %% Cross-provincial/state connections for context (optional, based on real-world travel)
//    Toronto --- Buffalo_NY(Buffalo - New York)
//    Windsor --- Detroit_MI(Detroit - Michigan)
//    ThunderBay --- Duluth_MN(Duluth - Minnesota)
// ----


This topological equivalency comes into play whenever there is a need to talk about routes, legs, river segments or similar things. It is intuitive to talk about a graph in which you have airports connected by routes, but the same graph can be inverted to talk about routes connected by airports. For instance, you can talk about the Seattle-San Francisco air route (which we can designate as SEA-SFO) and the San Francisco - Los Angeles route (SFO-LAX). SFO is a connection (a link) for the SEA-SFO and SFO-LAX routes.

In this respect, routes and airports are both domains, and as a consequence, their characteristics can be identified by the relevant properties for their specializization. An entity that is on a route domain, for instance, can talk about a location that's addressable as a distance indicator or time or percentage completed within the context, with a plane on that route able to determine its address relative to the path.